<!DOCTYPE html>
<html dir="ltr" lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="keywords" content="wrappixel, admin dashboard, html css dashboard, web dashboard, bootstrap 5 admin, bootstrap 5, css3 dashboard, bootstrap 5 dashboard, Flexy lite admin bootstrap 5 dashboard, frontend, responsive bootstrap 5 admin template, Flexy admin lite design, Flexy admin lite dashboard bootstrap 5 dashboard template">
  <meta name="description" content="Flexy Admin Lite is powerful and clean admin dashboard template, inpired from Bootstrap Framework">
  <meta name="robots" content="noindex,nofollow">
  <title>Produk - IndoApril</title>
  <link rel="canonical" href="https://www.wrappixel.com/templates/Flexy-admin-lite/" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <link rel="icon" type="image/png" sizes="16x16" href="assets/images/favicon.png">
  <link href="dist/css/style.min.css" rel="stylesheet">
  <link rel="stylesheet" href="//cdn.datatables.net/2.2.2/css/dataTables.dataTables.min.css">
</head>

<body>
  <div id="main-wrapper" data-layout="vertical" data-navbarbg="skin5" data-sidebartype="full" data-sidebar-position="absolute" data-header-position="absolute" data-boxed-layout="full">
    <!-- Start Header -->
    <header class="topbar" data-navbarbg="skin6">
      <nav class="navbar top-navbar navbar-expand-md navbar-light">
        <div class="navbar-header" data-logobg="skin6">
          <a class="navbar-brand" href="index.html">
            <b class="logo-icon">
              <img src="assets/images/logo-icon.png" alt="homepage" class="dark-logo" />
              <img src="assets/images/logo-light-icon.png" alt="homepage" class="light-logo" />
            </b>
            <span class="logo-text">
              <img src="assets/images/logo-text.png" alt="homepage" class="dark-logo" />
              <img src="assets/images/logo-light-text.png" class="light-logo" alt="homepage" />
            </span>
          </a>
          <a class="nav-toggler waves-effect waves-light d-block d-md-none" href="javascript:void(0)">
            <i class="mdi mdi-menu"></i>
          </a>
        </div>

        <div class="navbar-collapse collapse" id="navbarSupportedContent" data-navbarbg="skin5">
          <ul class="navbar-nav float-end ms-auto">
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle text-muted waves-effect waves-dark pro-pic" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <img src="assets/images/users/profile.png" alt="user" class="rounded-circle" width="31">
              </a>
              <ul class="dropdown-menu dropdown-menu-end user-dd animated" aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="javascript:void(0)">
                  <i class="mdi mdi-account-box"></i>
                  Administrator
                </a>
                <a class="dropdown-item" href="">
                  <i class="mdi mdi-logout"></i>
                  Logout
                </a>
              </ul>
            </li>
          </ul>
        </div>
      </nav>
    </header>
    <!-- End Header -->

    <!-- Start Aside -->
    <aside class="left-sidebar" data-sidebarbg="skin6">
      <div class="scroll-sidebar">
        <nav class="sidebar-nav">
          <ul id="sidebarnav">
            <li class="sidebar-item">
              <a class="sidebar-link waves-effect waves-dark sidebar-link" href="index.html" aria-expanded="false">
                <i class="mdi mdi-view-dashboard"></i>
                <span class="hide-menu">Dashboard</span>
              </a>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link waves-effect waves-dark sidebar-link" href="product.html" aria-expanded="false">
                <i class="mdi mdi-store"></i>
                <span class="hide-menu">Produk</span>
              </a>
            </li>
            <li class="sidebar-item selected">
              <a class="sidebar-link waves-effect waves-dark sidebar-link" href="transaction.html" aria-expanded="false">
                <i class="mdi mdi-cart"></i>
                <span class="hide-menu">Pembelian</span>
              </a>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link waves-effect waves-dark sidebar-link" href="user.html" aria-expanded="false">
                <i class="mdi mdi-account"></i>
                <span class="hide-menu">User</span>
              </a>
            </li>
          </ul>
        </nav>
      </div>
    </aside>
    <!-- End Aside -->

    <!-- Start Main Content -->
    <div class="page-wrapper">
      <div class="page-breadcrumb ">
        <div class="row align-items-center">
          <div class="col-6">
            <nav aria-label="breadcrumb">
              <ol class="breadcrumb mb-0 d-flex align-items-center">
                <li class="breadcrumb-item"><a href="index.html" class="link"><i class="mdi mdi-home-outline fs-4"></i></a></li>
                <li class="breadcrumb-item active" aria-current="page">Penjualan</li>
              </ol>
            </nav>
            <h1 class="mb-0 fw-bold">Penjualan</h1> 
          </div>
        </div>
      </div>
      <div class="container-fluid d-flex flex-column" style="min-height: 500px">
        <div class="row">
          <div class="col-12 max-h-auto">
            <div class="card">
              <div class="card-body">
                <div class="row">
                  <div class="col-lg-6 col-md-12 pe-5">
                    <table class="table">
                      <thead>
                        <tr>
                          <th scope="col" class="pt-0">Nama Produk</th>
                          <th scope="col" class="pt-0">Harga</th>
                          <th scope="col" class="pt-0">Kuantitas</th>
                          <th scope="col" class="pt-0">Subtotal</th>
                        </tr>
                      </thead>
                      <tbody class="table-group-divider">
                        <tr>
                          <td>Produk 1</td>
                          <td>Rp. 100.000</td>
                          <td>2</td>
                          <td>Rp. 200.000</td>
                        </tr>
                      </tbody>
                      <tfoot class="table-group-divider">
                        <td colspan="3" class="text-end"><strong>Kembalian:</strong></td>
                        <td id="totalChange">Rp. 0</td>
                      </tfoot>
                      <tfoot class="table-group-divider">
                        <td colspan="3" class="text-end"><strong>Total Harga:</strong></td>
                        <td>
                          <div id="totalPriceBeforeDiscount">Rp. 200.000</div>
                          <div class="d-none" id="totalPriceAfterDiscount">Rp. 200.000</div>
                        </td>
                      </tfoot>
                      <tfoot class="table-group-divider">
                        <td colspan="3" class="text-end"><strong>Total Bayar:</strong></td>
                        <td id="totalPaid">Rp. 200.000</td>
                      </tfoot>
                    </table>
                  </div>
                  <div class="col-lg-6 col-md-12 ps-5">
                    <form action="#" method="POST">
                      <div class="row">
                        <div class="form-group">
                          <label for="name" class="col-md-12">Nama Member (identitas)</label>
                          <div class="col-md-12">
                            <input type="text" class="form-control form-control-line" id="name" name="name" value="Member 1">
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="form-group">
                          <label for="points" class="col-md-12">Poin</label>
                          <div class="col-md-12">
                            <input type="number" class="form-control form-control-line" id="points" name="points" value="100" readonly>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="form-check ms-4">
                          <div class="col-md-12">
                            <input type="checkbox" class="form-check-input" id="check" name="check_poin" onchange="updateTotal()" {{ $isNewMember ? 'disabled' : '' }}>
                            <label for="check" class="form-check-label">Gunakan poin</label>
                            <!-- <small class="text-danger">Poin tidak dapat digunakan pada pembelanjaan pertama</small> -->
                          </div>
                        </div>
                      </div>
                      <input type="hidden" name="items" value="{{ old('items', json_encode($items)) }}">
                      <input type="hidden" name="total" value="{{ $total }}" id="total">
                      <input type="hidden" name="points_used" id="points_used">
                      <input type="hidden" name="amount_paid" value="{{ $amountPaid }}">
                      <input type="hidden" name="amount_change" value="{{ $amountChange }}">
                      <input type="hidden" name="phone_number" value="{{ $phoneNumber }}">
                      <input type="hidden" name="user_id" value="{{ Auth::user()->id }}">
                      <div class="row">
                        <div class="col-md-12 text-end">
                          <button class="btn btn-primary" type="submit">Pesan</button>
                        </div>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- End Main Content -->
  </div>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="assets/libs/jquery/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
  <script src="//cdn.datatables.net/2.2.2/js/dataTables.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    function updateTotal() {
      const points = parseInt(document.getElementById('points').value);
      const totalInput = document.querySelector('input[name="total"]');
      const amountPaid = parseInt(document.querySelector('input[name="amount_paid"]').value);
      const amountChangeInput = document.querySelector('input[name="amount_change"]');
      const amountChangeElement = document.getElementById('totalChange');
      const checkbox = document.getElementById('check');
      const pointsUsedInput = document.getElementById('points_used')
      
      const totalPricBeforeDiscounteElement = document.getElementById('totalPriceBeforeDiscount');
      const totalPriceAfterDiscountElement = document.getElementById('totalPriceAfterDiscount');

      let originalTotal = totalInput.dataset.originalTotal || (totalInput.dataset.originalTotal = totalInput.value);
      originalTotal = parseInt(originalTotal);

      let newTotal = checkbox.checked ? Math.max(originalTotal - points, 0) : originalTotal;
      let newAmountChange = Math.max(amountPaid - newTotal, 0);

      pointsUsedInput.value = checkbox.checked ? points : 0;

      totalInput.value = newTotal;
      amountChangeInput.value = newAmountChange;
      amountChangeElement.innerText = `Rp ${newAmountChange.toLocaleString('id-ID')}`;

      totalPricBeforeDiscounteElement.classList.toggle('text-decoration-line-through', checkbox.checked);
      totalPriceAfterDiscountElement.classList.toggle('d-none', !checkbox.checked);
      totalPriceAfterDiscountElement.innerText = `Rp ${newTotal.toLocaleString('id-ID')}`;
    }
  </script>
</body>
</html>